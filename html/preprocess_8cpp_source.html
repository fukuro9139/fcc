<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FCC: preprocess.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FCC
   </div>
   <div id="projectbrief">x86-64上で動作するLinux向けC言語コンパイラ</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('preprocess_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">preprocess.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="preprocess_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="preprocess_8hpp.html">preprocess.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tokenize_8hpp.html">tokenize.hpp</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="parse_8hpp.html">parse.hpp</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="input_8hpp.html">input.hpp</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="preprocess_8cpp.html#acb836bbdbeb1d56ddb68d0dff363f77e">   17</a></span>&#160;<span class="keyword">using</span> <a class="code" href="structPreProcess_1_1Macro.html">Macro</a> = <a class="code" href="preprocess_8cpp.html#acb836bbdbeb1d56ddb68d0dff363f77e">PreProcess::Macro</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="preprocess_8cpp.html#a07e4179182e4d1c6ae721ea06ae3d4ab">   18</a></span>&#160;<span class="keyword">using</span> <a class="code" href="structPreProcess_1_1CondIncl.html">CondIncl</a> = <a class="code" href="preprocess_8cpp.html#a07e4179182e4d1c6ae721ea06ae3d4ab">PreProcess::CondIncl</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<a class="code" href="structPreProcess_1_1CondIncl.html#af815f69b935d8edd58d9a4b40b6b1c70">CondIncl::CondIncl</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="structPreProcess_1_1CondIncl.html#a5c27ea7853ad98c597fe4f619d5b9c7f">   21</a></span>&#160;<a class="code" href="structPreProcess_1_1CondIncl.html#af815f69b935d8edd58d9a4b40b6b1c70">CondIncl::CondIncl</a>(unique_ptr&lt;Token&gt; &amp;&amp;token, <span class="keyword">const</span> <a class="code" href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcb">BlockKind</a> &amp;ctx, <span class="keywordtype">bool</span> included)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    : _token(move(token)), _ctx(ctx), _included(included) {}</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structPreProcess_1_1Macro.html#a958c28d8e3379804debf375f8470bb54">   24</a></span>&#160;<a class="code" href="structPreProcess_1_1Macro.html#a958c28d8e3379804debf375f8470bb54">Macro::Macro</a>(unique_ptr&lt;Token&gt; &amp;&amp;body, <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;objlike)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    : _body(move(body)), _is_objlike(objlike)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;vector&lt;unique_ptr&lt;CondIncl&gt;&gt; <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">PreProcess::cond_incl</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;std::unordered_map&lt;string, unique_ptr&lt;Macro&gt;&gt; <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">PreProcess::macros</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">const</span> <a class="code" href="classInput.html">Input</a> *<a class="code" href="classPreProcess.html#a1b061a47d53bcfcdee275c71db6497dd">PreProcess::input_options</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classPreProcess.html#a91fd2dee6da5c52f96c2acc129f0b87f">   44</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a91fd2dee6da5c52f96c2acc129f0b87f">PreProcess::preprocess</a>(unique_ptr&lt;Token&gt; &amp;&amp;token, <span class="keyword">const</span> unique_ptr&lt;Input&gt; &amp;in)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">/* 入力オプション */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classPreProcess.html#a1b061a47d53bcfcdee275c71db6497dd">input_options</a> = in.get();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">/* 事前定義マクロの定義 */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classPreProcess.html#a84776f1f73061583b46fa6b852d0edb5">init_macros</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">/* プリプロセスマクロとディレクティブを処理 */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    token = <a class="code" href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">preprocess2</a>(move(token));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">/* #ifと#endifの対応を確認 */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.empty())</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;対応する#endifが存在しません&quot;</span>, <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_token.get());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">/* 識別子を認識 */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classPreProcess.html#aac56dc3f421c3661abe7433e1ebd02b0">convert_keywords</a>(token);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">/* 連続する文字列リテラルを連結 */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classPreProcess.html#a68b7da4d7f6ec9e1c61f52a10b5f765c">join_adjacent_string_literals</a>(token.get());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> token;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">   76</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">PreProcess::preprocess2</a>(unique_ptr&lt;Token&gt; &amp;&amp;token)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">auto</span> head = make_unique_for_overwrite&lt;Token&gt;();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">auto</span> cur = head.get();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != token-&gt;_kind)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">/* マクロであれば展開する */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a11615dd7743b3be39b7692981f71df8e">expand_macro</a>(token, move(token)))</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">/* 行頭&#39;#&#39;でなければそのまま */</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">is_hash</a>(token))</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            cur-&gt;_next = move(token);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            token = move(cur-&gt;_next);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">auto</span> start = move(token);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        token = move(start-&gt;_next);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;error&quot;</span>))</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;Error&quot;</span>, token.get());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">/* &#39;#&#39;のみの行は無視する */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> (token-&gt;_at_begining)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;include&quot;</span>))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordtype">bool</span> dquote;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordtype">string</span> filename = <a class="code" href="classPreProcess.html#a5a4e441ea4d4288d1368d5cd5ce9f79e">read_include_filename</a>(token, move(token-&gt;_next), dquote);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="comment">/* includeするパスを検索する */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keyword">auto</span> inc_path = <a class="code" href="classPreProcess.html#a1283f06400c712b82e21043676a04168">search_include_path</a>(start-&gt;_file-&gt;_name, filename, dquote);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">/* 見つからなければエラー */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">if</span> (inc_path.empty())</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;ファイルが見つかりません&quot;</span>, start.get());</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">/* includeしたトークンを繋ぐ */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            token = <a class="code" href="classPreProcess.html#affa7ab13f72f0a7ba05d61c065d819b1">include_file</a>(move(token), inc_path);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;define&quot;</span>))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="comment">/* マクロの定義を読み取る */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="classPreProcess.html#a50972ace234a9b46f6fe159f66ad0f77">read_macro_definition</a>(token, move(token-&gt;_next));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;undef&quot;</span>))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            token = move(token-&gt;_next);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> != token-&gt;_kind)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;マクロ名は識別子である必要があります&quot;</span>, token.get());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="comment">/* マクロを削除する */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="classPreProcess.html#a8b15d1185f8632f45943b1698c89e107">delete_macro</a>(token-&gt;_str);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(token-&gt;_next));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;if&quot;</span>))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keyword">auto</span> val = <a class="code" href="classPreProcess.html#aeb85103b03341474aa2f8ec1dddbebd3">evaluate_const_expr</a>(token, move(token));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="classPreProcess.html#abb71205ac638eb6bf89863524cea3402">push_cond_incl</a>(move(start), val);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">/* #if の後の条件式が0（偽）であった場合は#endifまでスキップ */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span> (val == 0)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                token = <a class="code" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">skip_cond_incl</a>(move(token));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;ifdef&quot;</span>))</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordtype">bool</span> defined = <a class="code" href="classPreProcess.html#ae35d50a5b0d66814a491c52333e9cbd8">find_macro</a>(token-&gt;_next);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">/* #ifdef節に入る */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="classPreProcess.html#abb71205ac638eb6bf89863524cea3402">push_cond_incl</a>(move(start), defined);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="comment">/* 余分なトークンを飛ばす */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(token-&gt;_next-&gt;_next));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">/* 定義されていなければ節を飛ばす */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (!defined)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                token = <a class="code" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">skip_cond_incl</a>(move(token));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;ifndef&quot;</span>))</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">bool</span> defined = <a class="code" href="classPreProcess.html#ae35d50a5b0d66814a491c52333e9cbd8">find_macro</a>(token-&gt;_next);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">/* #ifndef節に入る */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="classPreProcess.html#abb71205ac638eb6bf89863524cea3402">push_cond_incl</a>(move(start), !defined);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">/* 余分なトークンを飛ばす */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(token-&gt;_next-&gt;_next));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">/* 定義されていれば節を飛ばす */</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">if</span> (defined)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                token = <a class="code" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">skip_cond_incl</a>(move(token));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;elif&quot;</span>))</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">/* 対になる#ifが存在しないまたは直前が#elseのときエラー */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.empty() || <a class="code" href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba7354d97ed514e740bd05e405792fb492">BlockKind::IN_ELSE</a> == <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_ctx)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;対応する#ifが存在しません&quot;</span>, start.get());</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment">/* #elif節に入ったので種類を変える */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_ctx = <a class="code" href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba4926e8dc115d230ce9db867b2efaab12">BlockKind::IN_ELIF</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">/* 直前の節の条件式が偽である、かつこの節の条件式が真であるとき */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_included &amp;&amp; <a class="code" href="classPreProcess.html#aeb85103b03341474aa2f8ec1dddbebd3">evaluate_const_expr</a>(token, move(token)) != 0)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_included = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="comment">/* それ以外はスキップ */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                token = <a class="code" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">skip_cond_incl</a>(move(token));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;else&quot;</span>))</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">/* 対になる#ifが存在しないまたは直前が#elseのときエラー */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.empty() || <a class="code" href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba7354d97ed514e740bd05e405792fb492">BlockKind::IN_ELSE</a> == <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_ctx)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;対応する#ifが存在しません&quot;</span>, start.get());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="comment">/* else節に入ったので種類を変える */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_ctx = <a class="code" href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba7354d97ed514e740bd05e405792fb492">BlockKind::IN_ELSE</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="comment">/* #elseと同じ行のトークンを無視 */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(token-&gt;_next));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="comment">/* #if節の方が有効な場合,else節はスキップ */</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back()-&gt;_included)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                token = <a class="code" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">skip_cond_incl</a>(move(token));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (token-&gt;is_equal(<span class="stringliteral">&quot;endif&quot;</span>))</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">/* 対になる#ifが存在しないとき */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.empty())</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;対応する#ifが存在しません&quot;</span>, start.get());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.pop_back();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(token-&gt;_next));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;無効なプリプロセッサディレクティブです&quot;</span>, token.get());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    cur-&gt;_next = move(token);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> move(head-&gt;_next);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classPreProcess.html#a9212e73d8df928c71ed3f8b030e46edd">  261</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a9212e73d8df928c71ed3f8b030e46edd">PreProcess::append</a>(unique_ptr&lt;Token&gt; &amp;&amp;token1, unique_ptr&lt;Token&gt; &amp;&amp;token2)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> == token1-&gt;_kind)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> token2;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">auto</span> tok = token1.get();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">/* トークン1を末尾まで辿る */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != tok-&gt;_next-&gt;_kind)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        tok = tok-&gt;_next.get();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    tok-&gt;_next = move(token2);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">return</span> token1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classPreProcess.html#aac56dc3f421c3661abe7433e1ebd02b0">  283</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#aac56dc3f421c3661abe7433e1ebd02b0">PreProcess::convert_keywords</a>(unique_ptr&lt;Token&gt; &amp;token)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classToken.html">Token</a> *t = token.get(); <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> == t-&gt;_kind &amp;&amp; <a class="code" href="classPreProcess.html#a44924a86138b2c9e191c068443e0ef77">is_keyword</a>(t))</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            t-&gt;_kind = <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25ab9fc925a96aedb831246043c98a84d7e">TokenKind::TK_KEYWORD</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classPreProcess.html#a44924a86138b2c9e191c068443e0ef77">  301</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classPreProcess.html#a44924a86138b2c9e191c068443e0ef77">PreProcess::is_keyword</a>(<span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *token)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;kw : <a class="code" href="classPreProcess.html#a5f89e29768d2b9ee1e6c9ffa967193ec">keywords</a>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span> (kw == token-&gt;<a class="code" href="classToken.html#a212ad23cad19dcc355b9b3832f95285e">_str</a>)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">  320</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">PreProcess::is_hash</a>(<span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;token)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">return</span> token-&gt;_at_begining &amp;&amp; token-&gt;is_equal(<span class="stringliteral">&quot;#&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">  332</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">PreProcess::skip_line</a>(unique_ptr&lt;Token&gt; &amp;&amp;token)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (token-&gt;_at_begining)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">return</span> token;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="common_8cpp.html#ac00192d849d9668352fb24ce744e927b">warn_token</a>(<span class="stringliteral">&quot;このトークンは無視されます&quot;</span>, 1, token.get());</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">while</span> (!token-&gt;_at_begining)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        token = move(token-&gt;_next);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> token;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classPreProcess.html#aa46bcfe831460da103def1f30ecafa77">  353</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#aa46bcfe831460da103def1f30ecafa77">PreProcess::new_eof_token</a>(<span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;src)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">auto</span> t = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(src.get());</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    t-&gt;_kind = <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    t-&gt;_str = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">  367</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#aa09b747bb391635809301738cf407f83">PreProcess::skip_cond_incl</a>(unique_ptr&lt;Token&gt; &amp;&amp;token)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != token-&gt;_kind)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">/* #if 0にネストされた#if, #ifdef, #ifndefはスキップする */</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">is_hash</a>(token) &amp;&amp; (token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;if&quot;</span>) ||</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                               token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;ifdef&quot;</span>) ||</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                               token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;ifndef&quot;</span>)))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            token = <a class="code" href="classPreProcess.html#a18a843657331be70c30044912fcc473e">skip_cond_incl2</a>(move(token-&gt;_next-&gt;_next));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">is_hash</a>(token) &amp;&amp;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            (token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;else&quot;</span>) || token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;endif&quot;</span>) || token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;elif&quot;</span>)))</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        token = move(token-&gt;_next);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> token;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classPreProcess.html#a18a843657331be70c30044912fcc473e">  397</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a18a843657331be70c30044912fcc473e">PreProcess::skip_cond_incl2</a>(unique_ptr&lt;Token&gt; &amp;&amp;token)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != token-&gt;_kind)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">/* #if 0にネストされた#if, #ifdef, #ifndefはスキップする */</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">is_hash</a>(token) &amp;&amp; (token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;if&quot;</span>) ||</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                               token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;ifdef&quot;</span>) ||</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                               token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;ifndef&quot;</span>)))</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            token = <a class="code" href="classPreProcess.html#a18a843657331be70c30044912fcc473e">skip_cond_incl2</a>(move(token-&gt;_next-&gt;_next));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a6d40206231796823710e84d42682d78d">is_hash</a>(token) &amp;&amp; token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;endif&quot;</span>))</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">return</span> move(token-&gt;_next-&gt;_next);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        token = move(token-&gt;_next);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">return</span> token;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classPreProcess.html#abd377b72552ff41935975bd95122066f">  427</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#abd377b72552ff41935975bd95122066f">PreProcess::copy_line</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keyword">auto</span> head = make_unique_for_overwrite&lt;Token&gt;();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keyword">auto</span> cur = head.get();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">for</span> (; !current_token-&gt;_at_begining; current_token = move(current_token-&gt;_next))</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(current_token.get());</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    cur-&gt;_next = <a class="code" href="classPreProcess.html#aa46bcfe831460da103def1f30ecafa77">new_eof_token</a>(current_token);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    next_token = move(current_token);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">return</span> move(head-&gt;_next);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classPreProcess.html#aeb85103b03341474aa2f8ec1dddbebd3">  449</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="classPreProcess.html#aeb85103b03341474aa2f8ec1dddbebd3">PreProcess::evaluate_const_expr</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">auto</span> start = current_token.get();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">/* 文末までのトークンを読み取る */</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keyword">auto</span> expr = <a class="code" href="classPreProcess.html#a3124fdaba62b10afda1a7f2105c1da30">read_const_expr</a>(next_token, move(current_token-&gt;_next));</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">/* 定数式の中のマクロを展開 */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    expr = <a class="code" href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">preprocess2</a>(move(expr));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">/* #ifの後に条件式がなければエラー */</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> == expr-&gt;_kind)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;条件式が存在しません&quot;</span>, start);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">/* 未定義のマクロは0として扱う */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = expr.get(); <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> == t-&gt;_kind)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keyword">auto</span> next = move(t-&gt;_next);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            *t = move(*<a class="code" href="classPreProcess.html#a4fb303c14d7fa21fdec75e59d863563a">new_num_token</a>(0, t));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            t-&gt;_next = move(next);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="classToken.html">Token</a> *rest;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">/* 定数式を評価 */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">auto</span> val = <a class="code" href="classNode.html#ae11ea1ada6e842418ef5ba9ac54e15ae">Node::const_expr</a>(&amp;rest, expr.get());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">/* 定数式の評価後に余ったトークンがあればエラー */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != rest-&gt;<a class="code" href="classToken.html#a5d13049554a1eb95010943875bbb87ec">_kind</a>)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;余分なトークンが存在します&quot;</span>, rest);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classPreProcess.html#a3124fdaba62b10afda1a7f2105c1da30">  495</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a3124fdaba62b10afda1a7f2105c1da30">PreProcess::read_const_expr</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keyword">auto</span> tok = <a class="code" href="classPreProcess.html#abd377b72552ff41935975bd95122066f">copy_line</a>(next_token, move(current_token));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keyword">auto</span> head = make_unique_for_overwrite&lt;Token&gt;();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">auto</span> cur = head.get();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != tok-&gt;_kind)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">/* &#39;defined(M)&#39;または&#39;define M&#39;はMが定義されていれば1されていなければ0 */</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">if</span> (tok-&gt;is_equal(<span class="stringliteral">&quot;defined&quot;</span>))</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keyword">auto</span> start = move(tok);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            tok = move(start-&gt;_next);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordtype">bool</span> has_paren = tok-&gt;is_equal(<span class="stringliteral">&quot;(&quot;</span>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">if</span> (has_paren)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                tok = move(tok-&gt;_next);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> != tok-&gt;_kind)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;definedの引数はマクロ名である必要があります&quot;</span>, start.get());</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            cur-&gt;_next = <a class="code" href="classPreProcess.html#a4fb303c14d7fa21fdec75e59d863563a">new_num_token</a>(<a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>.contains(tok-&gt;_str) ? 1 : 0, start.get());</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            tok = move(tok-&gt;_next);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span> (has_paren)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                tok = <a class="code" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">skip</a>(move(tok), <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        cur-&gt;_next = move(tok);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        tok = move(cur-&gt;_next);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    cur-&gt;_next = move(tok);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> move(head-&gt;_next);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="classPreProcess.html#abb71205ac638eb6bf89863524cea3402">  543</a></span>&#160;<a class="code" href="structPreProcess_1_1CondIncl.html">CondIncl</a> *<a class="code" href="classPreProcess.html#abb71205ac638eb6bf89863524cea3402">PreProcess::push_cond_incl</a>(unique_ptr&lt;Token&gt; &amp;&amp;token, <span class="keywordtype">bool</span> included)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;{</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keyword">auto</span> ci = make_unique&lt;CondIncl&gt;(move(token), <a class="code" href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba63b986b110529934503118c497c5245e">BlockKind::IN_THEN</a>, included);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.emplace_back(move(ci));</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">cond_incl</a>.back().get();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="classPreProcess.html#a50972ace234a9b46f6fe159f66ad0f77">  556</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#a50972ace234a9b46f6fe159f66ad0f77">PreProcess::read_macro_definition</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> != current_token-&gt;_kind)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;マクロ名は識別子である必要があります&quot;</span>, current_token.get());</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keyword">auto</span> name = move(current_token);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    current_token = move(name-&gt;_next);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">/* 関数マクロ */</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span> (!current_token-&gt;_has_space &amp;&amp; current_token-&gt;is_equal(<span class="stringliteral">&quot;(&quot;</span>))</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordtype">bool</span> is_variadic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keyword">auto</span> params = <a class="code" href="classPreProcess.html#ad5d93c9658be713a9669b45327bcf352">read_macro_params</a>(current_token, move(current_token-&gt;_next), is_variadic);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keyword">auto</span> m = <a class="code" href="classPreProcess.html#a9dbec266a03beda567d5faa26ea23ed8">add_macro</a>(name, <span class="keyword">false</span>, <a class="code" href="classPreProcess.html#abd377b72552ff41935975bd95122066f">copy_line</a>(next_token, move(current_token)));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        m-&gt;_params = move(params);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        m-&gt;_is_variadic = is_variadic;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">/* オブジェクトマクロ */</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="classPreProcess.html#a9dbec266a03beda567d5faa26ea23ed8">add_macro</a>(name, <span class="keyword">true</span>, <a class="code" href="classPreProcess.html#abd377b72552ff41935975bd95122066f">copy_line</a>(next_token, move(current_token)));</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="classPreProcess.html#ae35d50a5b0d66814a491c52333e9cbd8">  587</a></span>&#160;<a class="code" href="structPreProcess_1_1Macro.html">Macro</a> *<a class="code" href="classPreProcess.html#ae35d50a5b0d66814a491c52333e9cbd8">PreProcess::find_macro</a>(<span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;token)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> != token-&gt;_kind)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>.contains(token-&gt;_str))</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>[token-&gt;_str].get();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classPreProcess.html#a9dbec266a03beda567d5faa26ea23ed8">  612</a></span>&#160;<a class="code" href="structPreProcess_1_1Macro.html">Macro</a> *<a class="code" href="classPreProcess.html#a9dbec266a03beda567d5faa26ea23ed8">PreProcess::add_macro</a>(<span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;token, <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;is_objlike, unique_ptr&lt;Token&gt; &amp;&amp;body)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;{</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>.contains(token-&gt;_str))</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="common_8cpp.html#ac00192d849d9668352fb24ce744e927b">warn_token</a>(<span class="stringliteral">&quot;マクロが再定義されています&quot;</span>, 1, token.get());</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>[token-&gt;_str] = make_unique&lt;Macro&gt;(move(body), is_objlike);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>[token-&gt;_str].get();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="classPreProcess.html#a11615dd7743b3be39b7692981f71df8e">  630</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classPreProcess.html#a11615dd7743b3be39b7692981f71df8e">PreProcess::expand_macro</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keyword">auto</span> name = current_token-&gt;_str;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">auto</span> macro_token = move(current_token);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">if</span> (macro_token-&gt;_hideset &amp;&amp; macro_token-&gt;_hideset-&gt;contains(name))</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        next_token = move(macro_token);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">auto</span> m = <a class="code" href="classPreProcess.html#ae35d50a5b0d66814a491c52333e9cbd8">find_macro</a>(macro_token);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span> (!m)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        next_token = move(macro_token);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">/* 動的な事前定義マクロ（__LINE__など） */</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (m-&gt;_handler)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        next_token = m-&gt;_handler(macro_token.get());</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        next_token-&gt;_at_begining = macro_token-&gt;_at_begining;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        next_token-&gt;_has_space = macro_token-&gt;_has_space;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        next_token-&gt;_next = move(macro_token-&gt;_next);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">/* オブジェクトマクロ */</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span> (m-&gt;_is_objlike)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keyword">auto</span> body = <a class="code" href="classPreProcess.html#a256a8c4c4c23056d8f4257bd06b1f440">substitute_obj_macro</a>(macro_token, m-&gt;_body);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">/* 展開元のマクロの行数情報をコピー */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = body.get(); <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            t-&gt;_line_no = macro_token-&gt;_line_no;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="comment">/* 展開したマクロのトークンリストの末尾に現在のトークンシルトを接続する */</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        next_token = <a class="code" href="classPreProcess.html#a9212e73d8df928c71ed3f8b030e46edd">append</a>(move(body), move(macro_token-&gt;_next));</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        next_token-&gt;_at_begining = macro_token-&gt;_at_begining;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        next_token-&gt;_has_space = macro_token-&gt;_has_space;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">/* 関数マクロ */</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">/* 引数を取らない関数マクロはただの変数として扱う */</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (!macro_token-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;(&quot;</span>))</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        next_token = move(macro_token);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">/* 引数を読み取る */</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keyword">auto</span> args = <a class="code" href="classPreProcess.html#a39b2ebb23cb99e844db5c2661bcae46d">read_macro_args</a>(current_token, move(macro_token-&gt;_next-&gt;_next), *m-&gt;_params, m-&gt;_is_variadic);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">/* 引数を代入してマクロを展開する */</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">auto</span> body = <a class="code" href="classPreProcess.html#a673fd50b13cdd2dd7bb1f4225fa8615d">substitute_func_macro</a>(macro_token, m-&gt;_body, *args);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">/* 展開元のマクロの行数情報をコピー */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = body.get(); <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        t-&gt;_line_no = macro_token-&gt;_line_no;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    next_token = <a class="code" href="classPreProcess.html#a9212e73d8df928c71ed3f8b030e46edd">append</a>(move(body), move(current_token));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    next_token-&gt;_has_space = macro_token-&gt;_has_space;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    next_token-&gt;_at_begining = macro_token-&gt;_at_begining;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classPreProcess.html#a256a8c4c4c23056d8f4257bd06b1f440">  705</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a256a8c4c4c23056d8f4257bd06b1f440">PreProcess::substitute_obj_macro</a>(<span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;dst, <span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;macro)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">/* マクロの展開先のトークンリストをコピーする */</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keyword">auto</span> head = make_unique_for_overwrite&lt;Token&gt;();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="classPreProcess.html#a1fd1a909de48e3a28cedd8ff487284a7">copy_macro_token</a>(head.get(), macro.get(), dst-&gt;_str, dst-&gt;_hideset);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">return</span> move(head-&gt;_next);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="classPreProcess.html#a673fd50b13cdd2dd7bb1f4225fa8615d">  721</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a673fd50b13cdd2dd7bb1f4225fa8615d">PreProcess::substitute_func_macro</a>(<span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;dst, <span class="keyword">const</span> unique_ptr&lt;Token&gt; &amp;macro, <span class="keyword">const</span> <a class="code" href="preprocess_8hpp.html#aafede0143a33957bb6921447efabc76c">MacroArgs</a> &amp;args)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;{</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keyword">auto</span> name = dst-&gt;_str;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">/* マクロの展開先のトークンリストをコピーする */</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">auto</span> head = make_unique_for_overwrite&lt;Token&gt;();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">auto</span> cur = head.get();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keyword">auto</span> tok = macro.get();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != tok-&gt;_kind)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">/* #引数は引数をそのまま文字列リテラルとして置き換える */</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">if</span> (tok-&gt;is_equal(<span class="stringliteral">&quot;#&quot;</span>))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keywordflow">if</span> (!args.contains(tok-&gt;_next-&gt;_str))</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;&#39;#&#39;の後にはマクロ引数が必要です&quot;</span>, tok-&gt;_next.get());</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            cur-&gt;_next = <a class="code" href="classPreProcess.html#ac7edcad25ae8edd3111a393bf7dc46bc">stringize</a>(dst.get(), args.at(tok-&gt;_next-&gt;_str).get());</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            cur-&gt;_next-&gt;_at_begining = tok-&gt;_at_begining;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            cur-&gt;_next-&gt;_has_space = tok-&gt;_has_space;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            tok = tok-&gt;_next-&gt;_next.get();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">/* ##演算子 */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">if</span> (tok-&gt;is_equal(<span class="stringliteral">&quot;##&quot;</span>))</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keywordflow">if</span> (tok == head.get())</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;##演算子はマクロ定義の冒頭では使えません&quot;</span>, tok);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> == tok-&gt;_next-&gt;_kind)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;##演算子はマクロ定義の末尾では使えません&quot;</span>, tok);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="comment">/* ##演算子の二番目のオペランドが引数の場合 */</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordflow">if</span> (args.contains(tok-&gt;_next-&gt;_str))</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="keyword">auto</span> arg_token = args.at(tok-&gt;_next-&gt;_str).get();</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="comment">/* 引数が空でないとき引数の先頭トークンと連結する */</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != arg_token-&gt;_kind)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    *cur = move(*<a class="code" href="classPreProcess.html#a9a3dcb162db018044e7b68fd0fc5fbfb">paste</a>(cur, arg_token));</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = arg_token-&gt;_next.get(); <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                        cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(t);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                tok = tok-&gt;_next-&gt;_next.get();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="comment">/* ##演算子の二番目のオペランドが引数以外の場合 */</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            *cur = move(*<a class="code" href="classPreProcess.html#a9a3dcb162db018044e7b68fd0fc5fbfb">paste</a>(cur, tok-&gt;_next.get()));</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            tok = tok-&gt;_next-&gt;_next.get();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="comment">/* (引数トークン)##(トークン) */</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">if</span> (args.contains(tok-&gt;_str) &amp;&amp; tok-&gt;_next-&gt;is_equal(<span class="stringliteral">&quot;##&quot;</span>))</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keyword">auto</span> rhs = tok-&gt;_next-&gt;_next.get();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keyword">auto</span> arg_token = args.at(tok-&gt;_str).get();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="comment">/* １番目のオペランドの引数トークンが空の場合 */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> == arg_token-&gt;_kind)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="comment">/* 2番目のオペランドのトークンが引数の場合 */</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="keywordflow">if</span> (args.contains(rhs-&gt;_str))</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = args.at(rhs-&gt;_str).get(); <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                        cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(t);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="comment">/* 2番目のオペランドのトークンが引数でないトークンの場合 */</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(rhs);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                tok = rhs-&gt;_next.get();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="comment">/* １番目のオペランドの引数トークンが空ではない場合、引数の展開だけして連結は次のループに任せる */</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = arg_token; <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(t);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            tok = tok-&gt;_next.get();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">/* マクロの引数トークンの場合。マクロの引数にマクロが含まれる場合はマクロは完全に展開する */</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordflow">if</span> (args.contains(tok-&gt;_str))</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="classPreProcess.html#a1fd1a909de48e3a28cedd8ff487284a7">copy_macro_token</a>(cur, args.at(tok-&gt;_str).get(), name, dst-&gt;_hideset);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            cur-&gt;_next = <a class="code" href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">preprocess2</a>(move(cur-&gt;_next));</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            cur-&gt;_next-&gt;_has_space = tok-&gt;_has_space;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            cur-&gt;_next-&gt;_at_begining = tok-&gt;_at_begining;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != cur-&gt;_next-&gt;_kind)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            tok = tok-&gt;_next.get();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">/* マクロの引数トークンではない場合 */</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keyword">auto</span> t = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(tok);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="classPreProcess.html#ac8ca211024d65d9ae4407d5ca1a845d8">add_hideset</a>(t-&gt;_hideset, name);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">if</span> (dst-&gt;_hideset)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            t-&gt;_hideset-&gt;merge(*dst-&gt;_hideset);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        cur-&gt;_next = move(t);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        tok = tok-&gt;_next.get();</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(tok);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">return</span> move(head-&gt;_next);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;}</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="classPreProcess.html#ad5d93c9658be713a9669b45327bcf352">  858</a></span>&#160;unique_ptr&lt;vector&lt;string&gt;&gt; <a class="code" href="classPreProcess.html#ad5d93c9658be713a9669b45327bcf352">PreProcess::read_macro_params</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token, <span class="keywordtype">bool</span> &amp;is_variadic)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;{</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keyword">auto</span> params = make_unique&lt;vector&lt;string&gt;&gt;();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">/* &#39;)&#39;が出てくるまで読み込み続ける */</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">while</span> (!current_token-&gt;is_equal(<span class="stringliteral">&quot;)&quot;</span>))</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="comment">/* ２個目以降は&#39;,&#39;区切りが必要 */</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">if</span> (!first)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            current_token = <a class="code" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">skip</a>(move(current_token), <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">/* 可変長引数 */</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> (current_token-&gt;is_equal(<span class="stringliteral">&quot;...&quot;</span>))</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            is_variadic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            next_token = <a class="code" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">skip</a>(move(current_token-&gt;_next), <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">return</span> params;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="comment">/* 引数の名前は識別子である必要がある */</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> != current_token-&gt;_kind)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;識別子ではありません&quot;</span>, current_token.get());</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        params-&gt;emplace_back(current_token-&gt;_str);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        current_token = move(current_token-&gt;_next);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    next_token = move(current_token-&gt;_next);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">return</span> params;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="classPreProcess.html#a298ea16846590914050aa8b0b6c38762">  902</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a298ea16846590914050aa8b0b6c38762">PreProcess::resd_macro_arg_one</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token, <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;read_rest)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keyword">auto</span> head = make_unique_for_overwrite&lt;Token&gt;();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keyword">auto</span> cur = head.get();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">/* &#39;()&#39;の深さ */</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordtype">int</span> level = 0;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">for</span> (;;)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="comment">/* 深さが0 かつ &#39;)&#39;が出てきたらループを抜ける */</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">if</span> (level == 0 &amp;&amp; current_token-&gt;is_equal(<span class="stringliteral">&quot;)&quot;</span>))</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="comment">/* 深さが0 かつ read_restがfalseかつ&#39;,&#39;が出てきたらループを抜ける */</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">if</span> (level == 0 &amp;&amp; !read_rest &amp;&amp; current_token-&gt;is_equal(<span class="stringliteral">&quot;,&quot;</span>))</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> == current_token-&gt;_kind)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;引数が足りません&quot;</span>, current_token.get());</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="comment">/* &#39;()&#39;が出てきたら深さを変化させる */</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">if</span> (current_token-&gt;is_equal(<span class="stringliteral">&quot;(&quot;</span>))</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            ++level;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_token-&gt;is_equal(<span class="stringliteral">&quot;)&quot;</span>))</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            --level;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(current_token.get());</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        current_token = move(current_token-&gt;_next);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    cur-&gt;_next = <a class="code" href="classPreProcess.html#aa46bcfe831460da103def1f30ecafa77">new_eof_token</a>(current_token);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    next_token = move(current_token);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">return</span> move(head-&gt;_next);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;}</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno"><a class="line" href="classPreProcess.html#a39b2ebb23cb99e844db5c2661bcae46d">  954</a></span>&#160;unique_ptr&lt;MacroArgs&gt; <a class="code" href="classPreProcess.html#a39b2ebb23cb99e844db5c2661bcae46d">PreProcess::read_macro_args</a>(</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    unique_ptr&lt;Token&gt; &amp;next_token,</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    unique_ptr&lt;Token&gt; &amp;&amp;current_token,</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keyword">const</span> vector&lt;string&gt; &amp;params,</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;is_variadic)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;{</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keyword">auto</span> args = make_unique&lt;MacroArgs&gt;();</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;pp : params)</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordflow">if</span> (!first)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <span class="comment">/* 2個目以降では&#39;,&#39;区切りが必要 */</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            current_token = <a class="code" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">skip</a>(move(current_token), <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        (*args)[pp] = <a class="code" href="classPreProcess.html#a298ea16846590914050aa8b0b6c38762">resd_macro_arg_one</a>(current_token, move(current_token), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">/* 可変長引数 */</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (is_variadic)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        unique_ptr&lt;Token&gt; varg;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="comment">/* 残りの引数がないならEOFトークン */</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">if</span> (current_token-&gt;is_equal(<span class="stringliteral">&quot;)&quot;</span>))</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            varg = <a class="code" href="classPreProcess.html#aa46bcfe831460da103def1f30ecafa77">new_eof_token</a>(current_token);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">/* 残りの引数が存在するなら全て読み込む */</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">if</span> (!first)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="comment">/* 2個目以降では&#39;,&#39;区切りが必要 */</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                current_token = <a class="code" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">skip</a>(move(current_token), <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            varg = <a class="code" href="classPreProcess.html#a298ea16846590914050aa8b0b6c38762">resd_macro_arg_one</a>(current_token, move(current_token), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        (*args)[<span class="stringliteral">&quot;__VA_ARGS__&quot;</span>] = move(varg);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!current_token-&gt;is_equal(<span class="stringliteral">&quot;)&quot;</span>))</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;引数が多すぎます&quot;</span>, current_token.get());</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    next_token = move(current_token-&gt;_next);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span> args;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;}</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"><a class="line" href="classPreProcess.html#ac8ca211024d65d9ae4407d5ca1a845d8"> 1009</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#ac8ca211024d65d9ae4407d5ca1a845d8">PreProcess::add_hideset</a>(unique_ptr&lt;Hideset&gt; &amp;hs, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;{</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">/* hsが空なら新しく作成する */</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">if</span> (!hs)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        hs = make_unique&lt;Hideset&gt;();</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    hs-&gt;insert(name);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;}</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="classPreProcess.html#a8b15d1185f8632f45943b1698c89e107"> 1024</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#a8b15d1185f8632f45943b1698c89e107">PreProcess::delete_macro</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;{</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>.contains(name))</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>.erase(name);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;}</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"><a class="line" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4"> 1038</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">PreProcess::skip</a>(unique_ptr&lt;Token&gt; &amp;&amp;token, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;op)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;{</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">if</span> (!token-&gt;is_equal(op))</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;\&#39;&quot;</span> + op + <span class="stringliteral">&quot;\&#39;が必要です&quot;</span>, token.get());</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">return</span> move(token-&gt;_next);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;}</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="classPreProcess.html#a1fd1a909de48e3a28cedd8ff487284a7"> 1055</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#a1fd1a909de48e3a28cedd8ff487284a7">PreProcess::copy_macro_token</a>(<a class="code" href="classToken.html">Token</a> *dst, <span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *macro, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name, <span class="keyword">const</span> unique_ptr&lt;Hideset&gt; &amp;hs)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;{</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keyword">auto</span> tok = macro;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keyword">auto</span> cur = dst;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">/* 末尾まで順番に一つずつコピー */</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != tok-&gt;_kind)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        cur-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a> = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(tok);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        tok = tok-&gt;_next.get();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        cur = cur-&gt;_next.get();</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="comment">/* hidesetに展開するマクロ名を追加 */</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <a class="code" href="classPreProcess.html#ac8ca211024d65d9ae4407d5ca1a845d8">add_hideset</a>(cur-&gt;_hideset, name);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="comment">/* 展開元のトークンのhidesetとマージする */</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keywordflow">if</span> (hs)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            cur-&gt;_hideset-&gt;merge(*hs);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">/* EOFトークンをコピー */</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    cur-&gt;_next = <a class="code" href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a>(tok);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"><a class="line" href="classPreProcess.html#a9081e86007669df7f4c2c8a147df5438"> 1084</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="classPreProcess.html#a9081e86007669df7f4c2c8a147df5438">PreProcess::quate_string</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;str)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;{</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">string</span> buf;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">/* 文字列リテラルは&#39;&quot;&#39;で始まる */</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    buf.push_back(<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">/* 特殊文字はエスケープしてコピー */</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;c : str)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;\\&#39;</span> || c == <span class="charliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            buf.push_back(<span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        buf.push_back(c);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">/* 文字列リテラルは&#39;&quot;&#39;で終わる */</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    buf.push_back(<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"><a class="line" href="classPreProcess.html#accd93d737e4d613706da01483f7dbf0b"> 1110</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#accd93d737e4d613706da01483f7dbf0b">PreProcess::new_str_token</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;str, <span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *ref)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;{</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">/* 特殊文字をエスケープ */</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordtype">string</span> s = <a class="code" href="classPreProcess.html#a9081e86007669df7f4c2c8a147df5438">quate_string</a>(str);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    s.push_back(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">/* 文字列をもった仮想的なファイルをトークナイズする */</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097">vir_file_tokenize</a>(s, ref-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a5b76ad7024f328b49df305244f5560ba">_name</a>, ref-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a00671e840700bd612e839a4b88596dc1">_file_no</a>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;}</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"><a class="line" href="classPreProcess.html#a4fb303c14d7fa21fdec75e59d863563a"> 1126</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a4fb303c14d7fa21fdec75e59d863563a">PreProcess::new_num_token</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;val, <span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *ref)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;{</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordtype">string</span> s = std::to_string(val);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    s.push_back(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097">vir_file_tokenize</a>(s, ref-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a5b76ad7024f328b49df305244f5560ba">_name</a>, ref-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a00671e840700bd612e839a4b88596dc1">_file_no</a>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;}</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="classPreProcess.html#a44bbb240882e196c20caca7b69c2a3e7"> 1139</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="classPreProcess.html#a44bbb240882e196c20caca7b69c2a3e7">PreProcess::join_tokens</a>(<span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *start, <span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *end)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;{</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordtype">string</span> buf;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = start; t != end &amp;&amp; <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != t-&gt;_kind; t = t-&gt;_next.get())</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keywordflow">if</span> (t != start &amp;&amp; t-&gt;<a class="code" href="classToken.html#a8e6b187f91025cb04e146cb198be3780">_has_space</a>)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            buf.push_back(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        buf += <a class="code" href="classToken.html#a4ea18b8b0c3ff35bfcb7be4912aa6752">Token::reverse_str_literal</a>(t);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    buf.shrink_to_fit();</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"><a class="line" href="classPreProcess.html#ac7edcad25ae8edd3111a393bf7dc46bc"> 1162</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#ac7edcad25ae8edd3111a393bf7dc46bc">PreProcess::stringize</a>(<span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *ref, <span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *arg)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;{</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keyword">auto</span> s = <a class="code" href="classPreProcess.html#a44bbb240882e196c20caca7b69c2a3e7">join_tokens</a>(arg, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#accd93d737e4d613706da01483f7dbf0b">new_str_token</a>(s, ref);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;}</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"><a class="line" href="classPreProcess.html#a9a3dcb162db018044e7b68fd0fc5fbfb"> 1175</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a9a3dcb162db018044e7b68fd0fc5fbfb">PreProcess::paste</a>(<span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *lhs, <span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *rhs)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordtype">string</span> buf = <a class="code" href="classToken.html#a4ea18b8b0c3ff35bfcb7be4912aa6752">Token::reverse_str_literal</a>(lhs);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    buf += <a class="code" href="classToken.html#a4ea18b8b0c3ff35bfcb7be4912aa6752">Token::reverse_str_literal</a>(rhs);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    buf.push_back(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">/* ファイルをトークナイズする */</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keyword">auto</span> tok = <a class="code" href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097">vir_file_tokenize</a>(buf, lhs-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a5b76ad7024f328b49df305244f5560ba">_name</a>, lhs-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a00671e840700bd612e839a4b88596dc1">_file_no</a>);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != tok-&gt;_next-&gt;_kind)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;連結した文字列\&#39;&quot;</span> + buf + <span class="stringliteral">&quot;\&#39;は無効なトークンです&quot;</span>, lhs);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    tok-&gt;_has_space = lhs-&gt;<a class="code" href="classToken.html#a8e6b187f91025cb04e146cb198be3780">_has_space</a>;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    tok-&gt;_at_begining = lhs-&gt;<a class="code" href="classToken.html#a87be07cdd099d280ce063bffb4d6c341">_at_begining</a>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">return</span> tok;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;}</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"><a class="line" href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097"> 1198</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097">PreProcess::vir_file_tokenize</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;str, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;file_name, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;file_no)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;{</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="comment">/* ファイル構造体の実体を管理するための配列 */</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keyword">static</span> vector&lt;unique_ptr&lt;File&gt;&gt; files;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    files.push_back(make_unique&lt;File&gt;(file_name, file_no, str));</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">/* ファイルをトークナイズする */</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keyword">auto</span> tok = <a class="code" href="classToken.html#ae15394a7266d20ede72e23ec29dc70f3">Token::tokenize</a>(files.back().get());</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">return</span> tok;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"><a class="line" href="classPreProcess.html#a5a4e441ea4d4288d1368d5cd5ce9f79e"> 1217</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="classPreProcess.html#a5a4e441ea4d4288d1368d5cd5ce9f79e">PreProcess::read_include_filename</a>(unique_ptr&lt;Token&gt; &amp;next_token, unique_ptr&lt;Token&gt; &amp;&amp;current_token, <span class="keywordtype">bool</span> &amp;is_dquote)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;{</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">/* #include &quot;...&quot; */</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a027c5503eaae8eea4e318673094f103d">TokenKind::TK_STR</a> == current_token-&gt;_kind)</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        is_dquote = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="comment">/* エスケープを無効にして元々の文字列を戻す。</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">         * 例：&quot;C:\note&quot;に含まれる&quot;\n&quot;は改行文字ではない */</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordtype">string</span> name = <a class="code" href="classToken.html#a4ea18b8b0c3ff35bfcb7be4912aa6752">Token::reverse_str_literal</a>(current_token.get());</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="comment">/* インクルードの後のトークンは無視 */</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        next_token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(current_token-&gt;_next));</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="comment">/* 文字列リテラルの前後の&#39;&quot;&#39;を消す */</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">return</span> name.substr(1, name.size() - 2);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">/* #include &lt;...&gt; */</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">if</span> (current_token-&gt;is_equal(<span class="stringliteral">&quot;&lt;&quot;</span>))</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        is_dquote = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keyword">auto</span> start = current_token.get();</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keyword">auto</span> end = current_token-&gt;_next.get();</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">while</span> (!end-&gt;is_equal(<span class="stringliteral">&quot;&gt;&quot;</span>))</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> == end-&gt;_kind || end-&gt;_at_begining)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;\&#39;&gt;\&#39;がありません&quot;</span>, end);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            end = end-&gt;_next.get();</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keyword">auto</span> name = <a class="code" href="classPreProcess.html#a44bbb240882e196c20caca7b69c2a3e7">join_tokens</a>(start-&gt;_next.get(), end);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">/* インクルードの後のトークンは無視 */</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        next_token = <a class="code" href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">skip_line</a>(move(end-&gt;_next));</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">return</span> name;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">/* #include FOO</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">     * FOOはマクロであり&quot;...&quot;または&lt;...&gt;に展開される</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a> == current_token-&gt;_kind)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="comment">/* マクロを展開する */</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keyword">auto</span> tok = <a class="code" href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">preprocess2</a>(<a class="code" href="classPreProcess.html#abd377b72552ff41935975bd95122066f">copy_line</a>(next_token, move(current_token)));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a5a4e441ea4d4288d1368d5cd5ce9f79e">read_include_filename</a>(tok, move(tok), is_dquote);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">/* どれにも当てはまらなければエラー */</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <a class="code" href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a>(<span class="stringliteral">&quot;ファイル名ではありません&quot;</span>, current_token.get());</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;}</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="classPreProcess.html#affa7ab13f72f0a7ba05d61c065d819b1"> 1275</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#affa7ab13f72f0a7ba05d61c065d819b1">PreProcess::include_file</a>(unique_ptr&lt;Token&gt; &amp;&amp;follow_token, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;path)</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;{</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keyword">auto</span> include_token = <a class="code" href="classToken.html#a21f2b2f650d35fb68ea722b919f13861">Token::tokenize_file</a>(path);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a9212e73d8df928c71ed3f8b030e46edd">append</a>(move(include_token), move(follow_token));</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="classPreProcess.html#a1283f06400c712b82e21043676a04168"> 1289</a></span>&#160;<span class="keywordtype">string</span> <a class="code" href="classPreProcess.html#a1283f06400c712b82e21043676a04168">PreProcess::search_include_path</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;current_path, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;filename, <span class="keyword">const</span> <span class="keywordtype">bool</span> &amp;dquote)</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;{</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    constexpr string_view std_inc_path[] = {<span class="stringliteral">&quot;/usr/local/include&quot;</span>, <span class="stringliteral">&quot;/usr/include/x86_64-linux-gnu&quot;</span>, <span class="stringliteral">&quot;/usr/include&quot;</span>};</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    fs::path pfilename = filename;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">/* 絶対パス */</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordflow">if</span> (pfilename.is_absolute())</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">return</span> filename;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">/* 現在のファイル */</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    fs::path pcurrent_path = current_path;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="comment">/* インクルードするファイルのパス */</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    fs::path inc_path;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">/* #include &quot;...&quot;形式では現在のパスからの相対パスから探す */</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">if</span> (dquote)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="comment">/* 現在のファイルからの相対パス */</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        inc_path = pcurrent_path.replace_filename(filename);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="comment">/* ファイルが存在するとき読み込む */</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">if</span> (fs::is_regular_file(inc_path))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keywordflow">return</span> inc_path.string();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">/* -Iオプションで追加されたパスを検索する */</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;base_path : <a class="code" href="classPreProcess.html#a1b061a47d53bcfcdee275c71db6497dd">input_options</a>-&gt;<a class="code" href="classInput.html#a5a74fe54a2f9ce26e8d619e50c063e47">_include</a>)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">/* includeするファイルのパスを生成、base_pathからの相対パス */</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        inc_path = fs::path(base_path) / pfilename;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment">/* ファイルが存在するときパスを返す */</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">if</span> (fs::is_regular_file(inc_path))</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordflow">return</span> inc_path.string();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">/* 標準インクルードパスを検索する */</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;base_path : std_inc_path)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="comment">/* includeするファイルのパスを生成、base_pathからの相対パス */</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        inc_path = fs::path(base_path) / pfilename;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="comment">/* ファイルが存在するときパスを返す */</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordflow">if</span> (fs::is_regular_file(inc_path))</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordflow">return</span> inc_path.string();</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">/* 見つからなければ空文字列を返す */</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1"> 1352</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">PreProcess::define_macro</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;buf)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;{</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keyword">auto</span> tok = <a class="code" href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097">vir_file_tokenize</a>(buf, <span class="stringliteral">&quot;&lt;built-in&gt;&quot;</span>, 1);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>[name] = make_unique&lt;Macro&gt;(move(tok), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;}</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"><a class="line" href="classPreProcess.html#abff43050cb05ba771059788dd28a0a38"> 1364</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#abff43050cb05ba771059788dd28a0a38">PreProcess::add_builtin</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name, <span class="keyword">const</span> <a class="code" href="preprocess_8hpp.html#ae79bf07e04f47db15a85107b7398c731">Macro_handler_fn</a> &amp;fn)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;{</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keyword">auto</span> m = make_unique&lt;Macro&gt;(<span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    m-&gt;_handler = fn;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <a class="code" href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">macros</a>[name] = move(m);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;}</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"><a class="line" href="classPreProcess.html#a84776f1f73061583b46fa6b852d0edb5"> 1375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#a84776f1f73061583b46fa6b852d0edb5">PreProcess::init_macros</a>()</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;{</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="classPreProcess.html#abff43050cb05ba771059788dd28a0a38">add_builtin</a>(<span class="stringliteral">&quot;__FILE__&quot;</span>, <a class="code" href="classPreProcess.html#a7ac56b1ca54f3ab696bfc25b73af4d03">file_macro</a>);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <a class="code" href="classPreProcess.html#abff43050cb05ba771059788dd28a0a38">add_builtin</a>(<span class="stringliteral">&quot;__LINE__&quot;</span>, <a class="code" href="classPreProcess.html#aea2411827e6862785cb23165e7312c54">line_macro</a>);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;_LP64&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__C99_MACRO_WITH_VA_ARGS&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__LP64__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_DOUBLE__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_FLOAT__&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_INT__&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_LONG_DOUBLE__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_LONG_LONG__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_LONG__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_POINTER__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_PTRDIFF_T__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_SHORT__&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZEOF_SIZE_T__&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__SIZE_TYPE__&quot;</span>, <span class="stringliteral">&quot;unsigned long&quot;</span>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC_HOSTED__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC_NO_ATOMICS__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC_NO_COMPLEX__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC_NO_THREADS__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC_NO_VLA__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC_VERSION__&quot;</span>, <span class="stringliteral">&quot;201112L&quot;</span>);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__STDC__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__USER_LABEL_PREFIX__&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__alignof__&quot;</span>, <span class="stringliteral">&quot;_Alignof&quot;</span>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__amd64&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__amd64__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__fcc__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__const__&quot;</span>, <span class="stringliteral">&quot;const&quot;</span>);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__inline__&quot;</span>, <span class="stringliteral">&quot;inline&quot;</span>);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__signed__&quot;</span>, <span class="stringliteral">&quot;signed&quot;</span>);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__typeof__&quot;</span>, <span class="stringliteral">&quot;typeof&quot;</span>);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__volatile__&quot;</span>, <span class="stringliteral">&quot;volatile&quot;</span>);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__x86_64&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__x86_64__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__linux&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__linux__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__unix&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__unix__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;linux&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;unix&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__gnu_linux__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <a class="code" href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">define_macro</a>(<span class="stringliteral">&quot;__ELF__&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="classPreProcess.html#a7ac56b1ca54f3ab696bfc25b73af4d03"> 1434</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#a7ac56b1ca54f3ab696bfc25b73af4d03">PreProcess::file_macro</a>(<span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *macro_token)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;{</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#accd93d737e4d613706da01483f7dbf0b">new_str_token</a>(macro_token-&gt;<a class="code" href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">_file</a>-&gt;<a class="code" href="structToken_1_1File.html#a5b76ad7024f328b49df305244f5560ba">_name</a>, macro_token);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;}</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="classPreProcess.html#aea2411827e6862785cb23165e7312c54"> 1445</a></span>&#160;unique_ptr&lt;Token&gt; <a class="code" href="classPreProcess.html#aea2411827e6862785cb23165e7312c54">PreProcess::line_macro</a>(<span class="keyword">const</span> <a class="code" href="classToken.html">Token</a> *macro_token)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;{</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPreProcess.html#a4fb303c14d7fa21fdec75e59d863563a">new_num_token</a>(macro_token-&gt;<a class="code" href="classToken.html#aff3d40d48e27f1b2006f492abcb2569c">_line_no</a>, macro_token);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;}</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"><a class="line" href="classPreProcess.html#a68b7da4d7f6ec9e1c61f52a10b5f765c"> 1455</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPreProcess.html#a68b7da4d7f6ec9e1c61f52a10b5f765c">PreProcess::join_adjacent_string_literals</a>(<a class="code" href="classToken.html">Token</a> *token1)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;{</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a> != token1-&gt;<a class="code" href="classToken.html#a5d13049554a1eb95010943875bbb87ec">_kind</a>)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="comment">/* 文字列リテラルが連続しない場合はそのまま */</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a027c5503eaae8eea4e318673094f103d">TokenKind::TK_STR</a> != token1-&gt;<a class="code" href="classToken.html#a5d13049554a1eb95010943875bbb87ec">_kind</a> || <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a027c5503eaae8eea4e318673094f103d">TokenKind::TK_STR</a> != token1-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a>-&gt;_kind)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            token1 = token1-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a>.get();</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keyword">auto</span> token2 = token1-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a>.get();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordflow">while</span> (token2-&gt;_next-&gt;_kind == <a class="code" href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a027c5503eaae8eea4e318673094f103d">TokenKind::TK_STR</a>)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            token2 = token2-&gt;_next.get();</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keywordtype">string</span> buf = <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="comment">/* token1からtoken2まで文字列リテラルが連続しているのでまとめる */</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> t = token1; t != token2; t = t-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a>.get())</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            buf += t-&gt;_str.substr(1, t-&gt;_str.size() - 2);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        buf += token2-&gt;_str.substr(1, token2-&gt;_str.size() - 2);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        buf.push_back(<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        token1-&gt;<a class="code" href="classToken.html#a212ad23cad19dcc355b9b3832f95285e">_str</a> = buf;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        token1-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a> = move(token2-&gt;_next);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        token1 = token1-&gt;<a class="code" href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">_next</a>.get();</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;}</div>
<div class="ttc" id="aclassInput_html"><div class="ttname"><a href="classInput.html">Input</a></div><div class="ttdoc">入力に関連する操作をまとめたクラス</div><div class="ttdef"><b>Definition:</b> <a href="input_8hpp_source.html#l00020">input.hpp:21</a></div></div>
<div class="ttc" id="aclassInput_html_a5a74fe54a2f9ce26e8d619e50c063e47"><div class="ttname"><a href="classInput.html#a5a74fe54a2f9ce26e8d619e50c063e47">Input::_include</a></div><div class="ttdeci">vector&lt; string &gt; _include</div><div class="ttdef"><b>Definition:</b> <a href="input_8hpp_source.html#l00048">input.hpp:48</a></div></div>
<div class="ttc" id="aclassNode_html_ae11ea1ada6e842418ef5ba9ac54e15ae"><div class="ttname"><a href="classNode.html#ae11ea1ada6e842418ef5ba9ac54e15ae">Node::const_expr</a></div><div class="ttdeci">static int64_t const_expr(Token **next_token, Token *current_token)</div><div class="ttdoc">定数式を読み取って評価する</div><div class="ttdef"><b>Definition:</b> <a href="parse_8cpp_source.html#l02501">parse.cpp:2501</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a11615dd7743b3be39b7692981f71df8e"><div class="ttname"><a href="classPreProcess.html#a11615dd7743b3be39b7692981f71df8e">PreProcess::expand_macro</a></div><div class="ttdeci">static bool expand_macro(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token)</div><div class="ttdoc">トークンがマクロで登録済みならマクロを展開しtrueを返す。そうではないならfalseを返す</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00630">preprocess.cpp:630</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a1283f06400c712b82e21043676a04168"><div class="ttname"><a href="classPreProcess.html#a1283f06400c712b82e21043676a04168">PreProcess::search_include_path</a></div><div class="ttdeci">static string search_include_path(const string &amp;current_path, const string &amp;filename, const bool &amp;dquote)</div><div class="ttdoc">インクルードファイルのパスを検索する。見つからなければ空文字列を返す。</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01289">preprocess.cpp:1289</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a18a843657331be70c30044912fcc473e"><div class="ttname"><a href="classPreProcess.html#a18a843657331be70c30044912fcc473e">PreProcess::skip_cond_incl2</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; skip_cond_incl2(unique_ptr&lt; Token &gt; &amp;&amp;token)</div><div class="ttdoc">#endifが出てくるまでトークンをスキップする</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00397">preprocess.cpp:397</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a1b061a47d53bcfcdee275c71db6497dd"><div class="ttname"><a href="classPreProcess.html#a1b061a47d53bcfcdee275c71db6497dd">PreProcess::input_options</a></div><div class="ttdeci">static const Input * input_options</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00120">preprocess.hpp:120</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a1fd1a909de48e3a28cedd8ff487284a7"><div class="ttname"><a href="classPreProcess.html#a1fd1a909de48e3a28cedd8ff487284a7">PreProcess::copy_macro_token</a></div><div class="ttdeci">static void copy_macro_token(Token *dst, const Token *src, const string &amp;name, const unique_ptr&lt; Hideset &gt; &amp;hs)</div><div class="ttdoc">マクロの展開先のトークンリストをdstにコピーして繋ぐ</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01055">preprocess.cpp:1055</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a256a8c4c4c23056d8f4257bd06b1f440"><div class="ttname"><a href="classPreProcess.html#a256a8c4c4c23056d8f4257bd06b1f440">PreProcess::substitute_obj_macro</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; substitute_obj_macro(const unique_ptr&lt; Token &gt; &amp;dst, const unique_ptr&lt; Token &gt; &amp;macro)</div><div class="ttdoc">オブジェクトマクロを展開する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00705">preprocess.cpp:705</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a298ea16846590914050aa8b0b6c38762"><div class="ttname"><a href="classPreProcess.html#a298ea16846590914050aa8b0b6c38762">PreProcess::resd_macro_arg_one</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; resd_macro_arg_one(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token, const bool &amp;read_rest)</div><div class="ttdoc">関数マクロの引数となる定数式を1個分読み込む</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00902">preprocess.cpp:902</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a2ab7cf1acea0fd61de09e673f4dd15f4"><div class="ttname"><a href="classPreProcess.html#a2ab7cf1acea0fd61de09e673f4dd15f4">PreProcess::skip</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; skip(unique_ptr&lt; Token &gt; &amp;&amp;token, const string &amp;op)</div><div class="ttdoc">トークンが期待している文字列であれば次のトークンを返す。それ以外であればエラー</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01038">preprocess.cpp:1038</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a3124fdaba62b10afda1a7f2105c1da30"><div class="ttname"><a href="classPreProcess.html#a3124fdaba62b10afda1a7f2105c1da30">PreProcess::read_const_expr</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; read_const_expr(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token)</div><div class="ttdoc">定数式を読み取り途中にdefinedマクロがあれば展開する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00495">preprocess.cpp:495</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a375559d30d7b91a98fa91f25e5e44037"><div class="ttname"><a href="classPreProcess.html#a375559d30d7b91a98fa91f25e5e44037">PreProcess::macros</a></div><div class="ttdeci">static std::unordered_map&lt; string, unique_ptr&lt; Macro &gt; &gt; macros</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00119">preprocess.hpp:119</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a39b2ebb23cb99e844db5c2661bcae46d"><div class="ttname"><a href="classPreProcess.html#a39b2ebb23cb99e844db5c2661bcae46d">PreProcess::read_macro_args</a></div><div class="ttdeci">static unique_ptr&lt; MacroArgs &gt; read_macro_args(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token, const vector&lt; string &gt; &amp;params, const bool &amp;is_variadic)</div><div class="ttdoc">関数マクロの引数となる定数式を読み込み定義された名前と対応付ける</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00954">preprocess.cpp:954</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a44924a86138b2c9e191c068443e0ef77"><div class="ttname"><a href="classPreProcess.html#a44924a86138b2c9e191c068443e0ef77">PreProcess::is_keyword</a></div><div class="ttdeci">static bool is_keyword(const Token *token)</div><div class="ttdoc">トークンの識別子がキーワードかどうか判定する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00301">preprocess.cpp:301</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a44bbb240882e196c20caca7b69c2a3e7"><div class="ttname"><a href="classPreProcess.html#a44bbb240882e196c20caca7b69c2a3e7">PreProcess::join_tokens</a></div><div class="ttdeci">static string join_tokens(const Token *start, const Token *end)</div><div class="ttdoc">トークンが持つ文字列を結合して１つの文字列にする</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01139">preprocess.cpp:1139</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a4fb303c14d7fa21fdec75e59d863563a"><div class="ttname"><a href="classPreProcess.html#a4fb303c14d7fa21fdec75e59d863563a">PreProcess::new_num_token</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; new_num_token(const int &amp;val, const Token *ref)</div><div class="ttdoc">数値を数値トークンに変換する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01126">preprocess.cpp:1126</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a50972ace234a9b46f6fe159f66ad0f77"><div class="ttname"><a href="classPreProcess.html#a50972ace234a9b46f6fe159f66ad0f77">PreProcess::read_macro_definition</a></div><div class="ttdeci">static void read_macro_definition(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token)</div><div class="ttdoc">マクロの定義を読み込む</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00556">preprocess.cpp:556</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a5a4e441ea4d4288d1368d5cd5ce9f79e"><div class="ttname"><a href="classPreProcess.html#a5a4e441ea4d4288d1368d5cd5ce9f79e">PreProcess::read_include_filename</a></div><div class="ttdeci">static string read_include_filename(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token, bool &amp;is_dquote)</div><div class="ttdoc">#includeするファイルのファイル名を取得する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01217">preprocess.cpp:1217</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a5f89e29768d2b9ee1e6c9ffa967193ec"><div class="ttname"><a href="classPreProcess.html#a5f89e29768d2b9ee1e6c9ffa967193ec">PreProcess::keywords</a></div><div class="ttdeci">static constexpr string_view keywords[]</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00123">preprocess.hpp:123</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a62d39251004e4f675d8cc470a3a19af1"><div class="ttname"><a href="classPreProcess.html#a62d39251004e4f675d8cc470a3a19af1">PreProcess::define_macro</a></div><div class="ttdeci">static void define_macro(const string &amp;name, const string &amp;buf)</div><div class="ttdoc">マクロを定義する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01352">preprocess.cpp:1352</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a673fd50b13cdd2dd7bb1f4225fa8615d"><div class="ttname"><a href="classPreProcess.html#a673fd50b13cdd2dd7bb1f4225fa8615d">PreProcess::substitute_func_macro</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; substitute_func_macro(const unique_ptr&lt; Token &gt; &amp;dst, const unique_ptr&lt; Token &gt; &amp;macro, const MacroArgs &amp;args)</div><div class="ttdoc">関数マクロを展開する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00721">preprocess.cpp:721</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a68b7da4d7f6ec9e1c61f52a10b5f765c"><div class="ttname"><a href="classPreProcess.html#a68b7da4d7f6ec9e1c61f52a10b5f765c">PreProcess::join_adjacent_string_literals</a></div><div class="ttdeci">static void join_adjacent_string_literals(Token *token)</div><div class="ttdoc">連続する文字列リテラルをまとめる</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01455">preprocess.cpp:1455</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a6ce82d01922b51d71584068bb7fe217e"><div class="ttname"><a href="classPreProcess.html#a6ce82d01922b51d71584068bb7fe217e">PreProcess::skip_line</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; skip_line(unique_ptr&lt; Token &gt; &amp;&amp;token)</div><div class="ttdoc">一部のプリプロセッサディレクティブは次の行の前に余分なトークンを許容する。 この関数では次の行頭までトークンをスキップする</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00332">preprocess.cpp:332</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a6d40206231796823710e84d42682d78d"><div class="ttname"><a href="classPreProcess.html#a6d40206231796823710e84d42682d78d">PreProcess::is_hash</a></div><div class="ttdeci">static bool is_hash(const unique_ptr&lt; Token &gt; &amp;token)</div><div class="ttdoc">トークンが行頭で'#'であるか</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00320">preprocess.cpp:320</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a7438a4c57665a83a88c55c5910b2b065"><div class="ttname"><a href="classPreProcess.html#a7438a4c57665a83a88c55c5910b2b065">PreProcess::preprocess2</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; preprocess2(unique_ptr&lt; Token &gt; &amp;&amp;token)</div><div class="ttdoc">トークンリストを先頭から巡回してプリプロセスマクロとディレクティブを処理する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00076">preprocess.cpp:76</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a7ac56b1ca54f3ab696bfc25b73af4d03"><div class="ttname"><a href="classPreProcess.html#a7ac56b1ca54f3ab696bfc25b73af4d03">PreProcess::file_macro</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; file_macro(const Token *macro_token)</div><div class="ttdoc">__FILE__マクロ</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01434">preprocess.cpp:1434</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a7d251bbea6454ed0f79d736337991bcb"><div class="ttname"><a href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcb">PreProcess::BlockKind</a></div><div class="ttdeci">BlockKind</div><div class="ttdoc">#if関連のブロックの種類</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00032">preprocess.hpp:33</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a7d251bbea6454ed0f79d736337991bcba4926e8dc115d230ce9db867b2efaab12"><div class="ttname"><a href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba4926e8dc115d230ce9db867b2efaab12">PreProcess::BlockKind::IN_ELIF</a></div><div class="ttdeci">@ IN_ELIF</div></div>
<div class="ttc" id="aclassPreProcess_html_a7d251bbea6454ed0f79d736337991bcba63b986b110529934503118c497c5245e"><div class="ttname"><a href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba63b986b110529934503118c497c5245e">PreProcess::BlockKind::IN_THEN</a></div><div class="ttdeci">@ IN_THEN</div></div>
<div class="ttc" id="aclassPreProcess_html_a7d251bbea6454ed0f79d736337991bcba7354d97ed514e740bd05e405792fb492"><div class="ttname"><a href="classPreProcess.html#a7d251bbea6454ed0f79d736337991bcba7354d97ed514e740bd05e405792fb492">PreProcess::BlockKind::IN_ELSE</a></div><div class="ttdeci">@ IN_ELSE</div></div>
<div class="ttc" id="aclassPreProcess_html_a84776f1f73061583b46fa6b852d0edb5"><div class="ttname"><a href="classPreProcess.html#a84776f1f73061583b46fa6b852d0edb5">PreProcess::init_macros</a></div><div class="ttdeci">static void init_macros()</div><div class="ttdoc">事前定義マクロを定義する。（例：__STDC__）</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01375">preprocess.cpp:1375</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a8b15d1185f8632f45943b1698c89e107"><div class="ttname"><a href="classPreProcess.html#a8b15d1185f8632f45943b1698c89e107">PreProcess::delete_macro</a></div><div class="ttdeci">static void delete_macro(const string &amp;name)</div><div class="ttdoc">マクロを削除する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01024">preprocess.cpp:1024</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a9081e86007669df7f4c2c8a147df5438"><div class="ttname"><a href="classPreProcess.html#a9081e86007669df7f4c2c8a147df5438">PreProcess::quate_string</a></div><div class="ttdeci">static string quate_string(const string &amp;str)</div><div class="ttdoc">文字列に含まれる特殊文字をエスケープする</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01084">preprocess.cpp:1084</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a91fd2dee6da5c52f96c2acc129f0b87f"><div class="ttname"><a href="classPreProcess.html#a91fd2dee6da5c52f96c2acc129f0b87f">PreProcess::preprocess</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; preprocess(unique_ptr&lt; Token &gt; &amp;&amp;token, const unique_ptr&lt; Input &gt; &amp;in)</div><div class="ttdoc">プリプロセスを行う</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00044">preprocess.cpp:44</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a9212e73d8df928c71ed3f8b030e46edd"><div class="ttname"><a href="classPreProcess.html#a9212e73d8df928c71ed3f8b030e46edd">PreProcess::append</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; append(unique_ptr&lt; Token &gt; &amp;&amp;token1, unique_ptr&lt; Token &gt; &amp;&amp;token2)</div><div class="ttdoc">トークン1の末尾にトークン2を付け加える</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00261">preprocess.cpp:261</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a9a253b5e084f6858b17ed83e7c72c097"><div class="ttname"><a href="classPreProcess.html#a9a253b5e084f6858b17ed83e7c72c097">PreProcess::vir_file_tokenize</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; vir_file_tokenize(const string &amp;str, const string &amp;file_name, const int &amp;file_no)</div><div class="ttdoc">文字列strだけを持つ仮想的なファイルをトークナイズする。</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01198">preprocess.cpp:1198</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a9a3dcb162db018044e7b68fd0fc5fbfb"><div class="ttname"><a href="classPreProcess.html#a9a3dcb162db018044e7b68fd0fc5fbfb">PreProcess::paste</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; paste(const Token *lhs, const Token *rhs)</div><div class="ttdoc">2つのトークンを連結する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01175">preprocess.cpp:1175</a></div></div>
<div class="ttc" id="aclassPreProcess_html_a9dbec266a03beda567d5faa26ea23ed8"><div class="ttname"><a href="classPreProcess.html#a9dbec266a03beda567d5faa26ea23ed8">PreProcess::add_macro</a></div><div class="ttdeci">static Macro * add_macro(const unique_ptr&lt; Token &gt; &amp;token, const bool &amp;is_objlike, unique_ptr&lt; Token &gt; &amp;&amp;body)</div><div class="ttdoc">マクロを登録する。マクロが定義済みの場合は上書きする。</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00612">preprocess.cpp:612</a></div></div>
<div class="ttc" id="aclassPreProcess_html_aa09b747bb391635809301738cf407f83"><div class="ttname"><a href="classPreProcess.html#aa09b747bb391635809301738cf407f83">PreProcess::skip_cond_incl</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; skip_cond_incl(unique_ptr&lt; Token &gt; &amp;&amp;token)</div><div class="ttdoc">#elseまたは#endifが出てくるまでトークンをスキップする</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00367">preprocess.cpp:367</a></div></div>
<div class="ttc" id="aclassPreProcess_html_aa46bcfe831460da103def1f30ecafa77"><div class="ttname"><a href="classPreProcess.html#aa46bcfe831460da103def1f30ecafa77">PreProcess::new_eof_token</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; new_eof_token(const unique_ptr&lt; Token &gt; &amp;src)</div><div class="ttdoc">トークンの内容をコピーしてkindをTK_EOF, strを&quot;&quot;に変更する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00353">preprocess.cpp:353</a></div></div>
<div class="ttc" id="aclassPreProcess_html_aaa118fccd30a9973d1e39265093355c0"><div class="ttname"><a href="classPreProcess.html#aaa118fccd30a9973d1e39265093355c0">PreProcess::cond_incl</a></div><div class="ttdeci">static vector&lt; unique_ptr&lt; CondIncl &gt; &gt; cond_incl</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00118">preprocess.hpp:118</a></div></div>
<div class="ttc" id="aclassPreProcess_html_aac56dc3f421c3661abe7433e1ebd02b0"><div class="ttname"><a href="classPreProcess.html#aac56dc3f421c3661abe7433e1ebd02b0">PreProcess::convert_keywords</a></div><div class="ttdeci">static void convert_keywords(unique_ptr&lt; Token &gt; &amp;token)</div><div class="ttdoc">トークンを順番にみていってキーワードと一致していれば種類をキーワードに帰る</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00283">preprocess.cpp:283</a></div></div>
<div class="ttc" id="aclassPreProcess_html_abb71205ac638eb6bf89863524cea3402"><div class="ttname"><a href="classPreProcess.html#abb71205ac638eb6bf89863524cea3402">PreProcess::push_cond_incl</a></div><div class="ttdeci">static CondIncl * push_cond_incl(unique_ptr&lt; Token &gt; &amp;&amp;token, bool included)</div><div class="ttdoc">#ifをリストに追加する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00543">preprocess.cpp:543</a></div></div>
<div class="ttc" id="aclassPreProcess_html_abd377b72552ff41935975bd95122066f"><div class="ttname"><a href="classPreProcess.html#abd377b72552ff41935975bd95122066f">PreProcess::copy_line</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; copy_line(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token)</div><div class="ttdoc">次の行頭または末尾までのトークンを全てコピーする。 この関数は::if文を評価するためのトークンリストを作成するために用いる。</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00427">preprocess.cpp:427</a></div></div>
<div class="ttc" id="aclassPreProcess_html_abff43050cb05ba771059788dd28a0a38"><div class="ttname"><a href="classPreProcess.html#abff43050cb05ba771059788dd28a0a38">PreProcess::add_builtin</a></div><div class="ttdeci">static void add_builtin(const string &amp;name, const Macro_handler_fn &amp;fn)</div><div class="ttdoc">動的な事前定義マクロを定義する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01364">preprocess.cpp:1364</a></div></div>
<div class="ttc" id="aclassPreProcess_html_ac7edcad25ae8edd3111a393bf7dc46bc"><div class="ttname"><a href="classPreProcess.html#ac7edcad25ae8edd3111a393bf7dc46bc">PreProcess::stringize</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; stringize(const Token *ref, const Token *arg)</div><div class="ttdoc">文字列化演算子'#'に対応するための関数。トークンリストargのトークンを文字列リテラル として統合し、トークナイズしたトークンを返す。</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01162">preprocess.cpp:1162</a></div></div>
<div class="ttc" id="aclassPreProcess_html_ac8ca211024d65d9ae4407d5ca1a845d8"><div class="ttname"><a href="classPreProcess.html#ac8ca211024d65d9ae4407d5ca1a845d8">PreProcess::add_hideset</a></div><div class="ttdeci">static void add_hideset(unique_ptr&lt; Hideset &gt; &amp;hs, const string &amp;name)</div><div class="ttdoc">hidesetにマクロ名を追加する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01009">preprocess.cpp:1009</a></div></div>
<div class="ttc" id="aclassPreProcess_html_accd93d737e4d613706da01483f7dbf0b"><div class="ttname"><a href="classPreProcess.html#accd93d737e4d613706da01483f7dbf0b">PreProcess::new_str_token</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; new_str_token(const string &amp;str, const Token *ref)</div><div class="ttdoc">文字列を文字列リテラルトークンに変換する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01110">preprocess.cpp:1110</a></div></div>
<div class="ttc" id="aclassPreProcess_html_ad5d93c9658be713a9669b45327bcf352"><div class="ttname"><a href="classPreProcess.html#ad5d93c9658be713a9669b45327bcf352">PreProcess::read_macro_params</a></div><div class="ttdeci">static unique_ptr&lt; vector&lt; string &gt; &gt; read_macro_params(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token, bool &amp;is_variadic)</div><div class="ttdoc">関数マクロの引数の定義を読み取る</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00858">preprocess.cpp:858</a></div></div>
<div class="ttc" id="aclassPreProcess_html_ae35d50a5b0d66814a491c52333e9cbd8"><div class="ttname"><a href="classPreProcess.html#ae35d50a5b0d66814a491c52333e9cbd8">PreProcess::find_macro</a></div><div class="ttdeci">static Macro * find_macro(const unique_ptr&lt; Token &gt; &amp;token)</div><div class="ttdoc">定義済みのマクロを検索して定義されていれば展開先のトークンリストを返す</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00587">preprocess.cpp:587</a></div></div>
<div class="ttc" id="aclassPreProcess_html_aea2411827e6862785cb23165e7312c54"><div class="ttname"><a href="classPreProcess.html#aea2411827e6862785cb23165e7312c54">PreProcess::line_macro</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; line_macro(const Token *macro_token)</div><div class="ttdoc">__LINE__マクロ</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01445">preprocess.cpp:1445</a></div></div>
<div class="ttc" id="aclassPreProcess_html_aeb85103b03341474aa2f8ec1dddbebd3"><div class="ttname"><a href="classPreProcess.html#aeb85103b03341474aa2f8ec1dddbebd3">PreProcess::evaluate_const_expr</a></div><div class="ttdeci">static long evaluate_const_expr(unique_ptr&lt; Token &gt; &amp;next_token, unique_ptr&lt; Token &gt; &amp;&amp;current_token)</div><div class="ttdoc">次の文末までを定数式として評価する</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00449">preprocess.cpp:449</a></div></div>
<div class="ttc" id="aclassPreProcess_html_affa7ab13f72f0a7ba05d61c065d819b1"><div class="ttname"><a href="classPreProcess.html#affa7ab13f72f0a7ba05d61c065d819b1">PreProcess::include_file</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; include_file(unique_ptr&lt; Token &gt; &amp;&amp;follow_token, const string &amp;path)</div><div class="ttdoc">ファイルをインクルードする。</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l01275">preprocess.cpp:1275</a></div></div>
<div class="ttc" id="aclassToken_html"><div class="ttname"><a href="classToken.html">Token</a></div><div class="ttdoc">トークンを表すクラス</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00035">tokenize.hpp:36</a></div></div>
<div class="ttc" id="aclassToken_html_a212ad23cad19dcc355b9b3832f95285e"><div class="ttname"><a href="classToken.html#a212ad23cad19dcc355b9b3832f95285e">Token::_str</a></div><div class="ttdeci">string _str</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00062">tokenize.hpp:62</a></div></div>
<div class="ttc" id="aclassToken_html_a21f2b2f650d35fb68ea722b919f13861"><div class="ttname"><a href="classToken.html#a21f2b2f650d35fb68ea722b919f13861">Token::tokenize_file</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; tokenize_file(const string &amp;input_path)</div><div class="ttdoc">入力されたパスにあるファイルを開いてトークナイズする</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8cpp_source.html#l00126">tokenize.cpp:126</a></div></div>
<div class="ttc" id="aclassToken_html_a249161422e2aee52bdc7f6aac89a3ebf"><div class="ttname"><a href="classToken.html#a249161422e2aee52bdc7f6aac89a3ebf">Token::_file</a></div><div class="ttdeci">const File * _file</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00063">tokenize.hpp:63</a></div></div>
<div class="ttc" id="aclassToken_html_a4ca4f46f400f74b863a35a7759afbae0"><div class="ttname"><a href="classToken.html#a4ca4f46f400f74b863a35a7759afbae0">Token::_next</a></div><div class="ttdeci">unique_ptr&lt; Token &gt; _next</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00056">tokenize.hpp:56</a></div></div>
<div class="ttc" id="aclassToken_html_a4ea18b8b0c3ff35bfcb7be4912aa6752"><div class="ttname"><a href="classToken.html#a4ea18b8b0c3ff35bfcb7be4912aa6752">Token::reverse_str_literal</a></div><div class="ttdeci">static string reverse_str_literal(const Token *token)</div><div class="ttdoc">トークンに対応する元々の入力文字列を返す。 文字列リテラルは特殊文字がエスケープされているので元々の文字列から該当部分を出力する</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8cpp_source.html#l00884">tokenize.cpp:884</a></div></div>
<div class="ttc" id="aclassToken_html_a5d13049554a1eb95010943875bbb87ec"><div class="ttname"><a href="classToken.html#a5d13049554a1eb95010943875bbb87ec">Token::_kind</a></div><div class="ttdeci">TokenKind _kind</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00057">tokenize.hpp:57</a></div></div>
<div class="ttc" id="aclassToken_html_a791da3ed80599c460288112f6942f243"><div class="ttname"><a href="classToken.html#a791da3ed80599c460288112f6942f243">Token::copy_token</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; copy_token(const Token *src)</div><div class="ttdoc">_next以外の要素をコピーして新たなトークンを生成し、そのトークンへのポインタを返す。</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8cpp_source.html#l00916">tokenize.cpp:916</a></div></div>
<div class="ttc" id="aclassToken_html_a87be07cdd099d280ce063bffb4d6c341"><div class="ttname"><a href="classToken.html#a87be07cdd099d280ce063bffb4d6c341">Token::_at_begining</a></div><div class="ttdeci">bool _at_begining</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00065">tokenize.hpp:65</a></div></div>
<div class="ttc" id="aclassToken_html_a8e6b187f91025cb04e146cb198be3780"><div class="ttname"><a href="classToken.html#a8e6b187f91025cb04e146cb198be3780">Token::_has_space</a></div><div class="ttdeci">bool _has_space</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00066">tokenize.hpp:66</a></div></div>
<div class="ttc" id="aclassToken_html_ae15394a7266d20ede72e23ec29dc70f3"><div class="ttname"><a href="classToken.html#ae15394a7266d20ede72e23ec29dc70f3">Token::tokenize</a></div><div class="ttdeci">static unique_ptr&lt; Token &gt; tokenize(const File *file)</div><div class="ttdoc">入力文字列をトークナイズする</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8cpp_source.html#l00148">tokenize.cpp:148</a></div></div>
<div class="ttc" id="aclassToken_html_aff3d40d48e27f1b2006f492abcb2569c"><div class="ttname"><a href="classToken.html#aff3d40d48e27f1b2006f492abcb2569c">Token::_line_no</a></div><div class="ttdeci">int _line_no</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00064">tokenize.hpp:64</a></div></div>
<div class="ttc" id="acommon_8cpp_html_a1e4265113288c7d43237908030b7b964"><div class="ttname"><a href="common_8cpp.html#a1e4265113288c7d43237908030b7b964">error_token</a></div><div class="ttdeci">void error_token(string &amp;&amp;msg, const Token *token)</div><div class="ttdoc">トークンを受け取ってエラーメッセージを出力</div><div class="ttdef"><b>Definition:</b> <a href="common_8cpp_source.html#l00115">common.cpp:115</a></div></div>
<div class="ttc" id="acommon_8cpp_html_ac00192d849d9668352fb24ce744e927b"><div class="ttname"><a href="common_8cpp.html#ac00192d849d9668352fb24ce744e927b">warn_token</a></div><div class="ttdeci">void warn_token(string &amp;&amp;msg, const int &amp;level, Token *token)</div><div class="ttdoc">警告を出力する</div><div class="ttdef"><b>Definition:</b> <a href="common_8cpp_source.html#l00128">common.cpp:128</a></div></div>
<div class="ttc" id="ainput_8hpp_html"><div class="ttname"><a href="input_8hpp.html">input.hpp</a></div><div class="ttdoc">入力された引数を解析するためのクラス</div></div>
<div class="ttc" id="aparse_8hpp_html"><div class="ttname"><a href="parse_8hpp.html">parse.hpp</a></div><div class="ttdoc">C言語の再帰下降構文解析を行うパーサーの定義</div></div>
<div class="ttc" id="apreprocess_8cpp_html_a07e4179182e4d1c6ae721ea06ae3d4ab"><div class="ttname"><a href="preprocess_8cpp.html#a07e4179182e4d1c6ae721ea06ae3d4ab">CondIncl</a></div><div class="ttdeci">PreProcess::CondIncl CondIncl</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00018">preprocess.cpp:18</a></div></div>
<div class="ttc" id="apreprocess_8cpp_html_acb836bbdbeb1d56ddb68d0dff363f77e"><div class="ttname"><a href="preprocess_8cpp.html#acb836bbdbeb1d56ddb68d0dff363f77e">Macro</a></div><div class="ttdeci">PreProcess::Macro Macro</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00017">preprocess.cpp:17</a></div></div>
<div class="ttc" id="apreprocess_8hpp_html"><div class="ttname"><a href="preprocess_8hpp.html">preprocess.hpp</a></div><div class="ttdoc">プリプロセスを行う</div></div>
<div class="ttc" id="apreprocess_8hpp_html_aafede0143a33957bb6921447efabc76c"><div class="ttname"><a href="preprocess_8hpp.html#aafede0143a33957bb6921447efabc76c">MacroArgs</a></div><div class="ttdeci">std::unordered_map&lt; string, unique_ptr&lt; Token &gt; &gt; MacroArgs</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00018">preprocess.hpp:18</a></div></div>
<div class="ttc" id="apreprocess_8hpp_html_ae79bf07e04f47db15a85107b7398c731"><div class="ttname"><a href="preprocess_8hpp.html#ae79bf07e04f47db15a85107b7398c731">Macro_handler_fn</a></div><div class="ttdeci">unique_ptr&lt; Token &gt;(*)(const Token *) Macro_handler_fn</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00019">preprocess.hpp:19</a></div></div>
<div class="ttc" id="astructPreProcess_1_1CondIncl_html"><div class="ttname"><a href="structPreProcess_1_1CondIncl.html">PreProcess::CondIncl</a></div><div class="ttdoc">#if関連を表す構造体</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00044">preprocess.hpp:45</a></div></div>
<div class="ttc" id="astructPreProcess_1_1CondIncl_html_af815f69b935d8edd58d9a4b40b6b1c70"><div class="ttname"><a href="structPreProcess_1_1CondIncl.html#af815f69b935d8edd58d9a4b40b6b1c70">PreProcess::CondIncl::CondIncl</a></div><div class="ttdeci">CondIncl()</div></div>
<div class="ttc" id="astructPreProcess_1_1Macro_html"><div class="ttname"><a href="structPreProcess_1_1Macro.html">PreProcess::Macro</a></div><div class="ttdoc">マクロを表す構造体</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8hpp_source.html#l00058">preprocess.hpp:59</a></div></div>
<div class="ttc" id="astructPreProcess_1_1Macro_html_a958c28d8e3379804debf375f8470bb54"><div class="ttname"><a href="structPreProcess_1_1Macro.html#a958c28d8e3379804debf375f8470bb54">PreProcess::Macro::Macro</a></div><div class="ttdeci">Macro(unique_ptr&lt; Token &gt; &amp;&amp;body, const bool &amp;objlike)</div><div class="ttdef"><b>Definition:</b> <a href="preprocess_8cpp_source.html#l00024">preprocess.cpp:24</a></div></div>
<div class="ttc" id="astructToken_1_1File_html_a00671e840700bd612e839a4b88596dc1"><div class="ttname"><a href="structToken_1_1File.html#a00671e840700bd612e839a4b88596dc1">Token::File::_file_no</a></div><div class="ttdeci">int _file_no</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00045">tokenize.hpp:45</a></div></div>
<div class="ttc" id="astructToken_1_1File_html_a5b76ad7024f328b49df305244f5560ba"><div class="ttname"><a href="structToken_1_1File.html#a5b76ad7024f328b49df305244f5560ba">Token::File::_name</a></div><div class="ttdeci">string _name</div><div class="ttdef"><b>Definition:</b> <a href="tokenize_8hpp_source.html#l00044">tokenize.hpp:44</a></div></div>
<div class="ttc" id="atokenize_8hpp_html"><div class="ttname"><a href="tokenize_8hpp.html">tokenize.hpp</a></div><div class="ttdoc">文字列をトークンに変換するトークナイザの定義</div></div>
<div class="ttc" id="atokenize_8hpp_html_a7a47dce04185ce6008048622cc792f25a027c5503eaae8eea4e318673094f103d"><div class="ttname"><a href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a027c5503eaae8eea4e318673094f103d">TokenKind::TK_STR</a></div><div class="ttdeci">@ TK_STR</div></div>
<div class="ttc" id="atokenize_8hpp_html_a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac"><div class="ttname"><a href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a914fa90ae0b3672a59ef3e40ec9c37ac">TokenKind::TK_EOF</a></div><div class="ttdeci">@ TK_EOF</div></div>
<div class="ttc" id="atokenize_8hpp_html_a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536"><div class="ttname"><a href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25a9998c5e76aaad4e6a2d6e4ae883b0536">TokenKind::TK_IDENT</a></div><div class="ttdeci">@ TK_IDENT</div></div>
<div class="ttc" id="atokenize_8hpp_html_a7a47dce04185ce6008048622cc792f25ab9fc925a96aedb831246043c98a84d7e"><div class="ttname"><a href="tokenize_8hpp.html#a7a47dce04185ce6008048622cc792f25ab9fc925a96aedb831246043c98a84d7e">TokenKind::TK_KEYWORD</a></div><div class="ttdeci">@ TK_KEYWORD</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="preprocess_8cpp.html">preprocess.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
